---
import { getCollection } from "astro:content";
import Layout from "@/layouts/Layout.astro";
import Container from "@/components/container.astro";
import Sectionhead from "@/components/sectionhead.astro";
import FounderCard from "@/components/founder-card.astro";

// Get the company story
const aboutEntries = await getCollection("about");
const companyStory = aboutEntries.find((entry) => entry.slug === "company-story");
const { Content } = companyStory ? await companyStory.render() : { Content: null };

// Get founders sorted by order
const founders = (await getCollection("founders", ({ data }) => {
  return !data.draft && data.publishDate < new Date();
})).sort((a, b) => a.data.order - b.data.order);
---

<Layout title="Chi Siamo">
  <Container>
    <Sectionhead>
      <Fragment slot="title">Chi Siamo</Fragment>
      <Fragment slot="desc">Il team dietro CrownServer</Fragment>
    </Sectionhead>

    {/* Company Story */}
    {Content && (
      <div class="prose prose-lg max-w-4xl mx-auto mt-16">
        <Content />
      </div>
    )}

    {/* Founders Section */}
    <div class="mt-24 mb-12">
      <h2 class="text-4xl font-bold text-center text-[#333333] mb-16">
        I Nostri Fondatori
      </h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-7xl mx-auto">
        {founders.map((founder) => (
          <FounderCard
            name={founder.data.name}
            role={founder.data.role}
            bio={founder.data.bio}
            avatarSeed={founder.data.avatar.seed}
            avatarStyle={founder.data.avatar.style}
          />
        ))}
      </div>
    </div>
  </Container>
</Layout>
